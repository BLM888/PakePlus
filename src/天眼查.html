<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>天眼系统</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'deep-blue': '#0B1C48',
            'space-black': '#050A1A',
            'warm-gold': '#D4AF37',
            'neon-blue': '#1E90FF',
            'glow-blue': '#00FFFF',
          },
          fontFamily: {
            'cyber': ['Orbitron', 'sans-serif'],
          },
          animation: {
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
          },
          keyframes: {
            glow: {
              '0%': { textShadow: '0 0 5px #fff, 0 0 10px #1E90FF, 0 0 15px #1E90FF' },
              '100%': { textShadow: '0 0 10px #fff, 0 0 20px #00FFFF, 0 0 30px #00FFFF' },
            }
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-glow {
        text-shadow: 0 0 10px rgba(30, 144, 255, 0.8), 0 0 20px rgba(30, 144, 255, 0.5);
      }
      .border-glow {
        box-shadow: 0 0 5px rgba(30, 144, 255, 0.8), 0 0 10px rgba(30, 144, 255, 0.5);
      }
      .bg-grid {
        background-image: 
          linear-gradient(rgba(30, 144, 255, 0.1) 1px, transparent 1px),
          linear-gradient(90deg, rgba(30, 144, 255, 0.1) 1px, transparent 1px);
        background-size: 20px 20px;
      }
      .glass-effect {
        background: rgba(11, 28, 72, 0.4);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
      }
      .progress-bar {
        height: 6px;
        border-radius: 3px;
        overflow: hidden;
      }
      .progress-value {
        height: 100%;
        transition: width 1s ease-in-out;
      }
      .modal-scroll {
        max-height: 70vh;
        overflow-y: auto;
      }
      .error-border {
        border-color: #dc2626 !important;
      }
      .error-text {
        color: #f87171;
        font-size: 0.875rem;
        margin-top: 0.25rem;
      }
    }
  </style>
  
  <!-- 导入字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="bg-space-black text-gray-200 min-h-screen bg-grid overflow-x-hidden">
  <!-- 顶部导航栏 -->
  <header class="relative glass-effect border-b border-neon-blue/30 py-4 px-6">
    <div class="container mx-auto flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <i class="fa fa-database text-warm-gold text-3xl animate-pulse-slow"></i>
        <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-cyber font-bold text-white animate-glow">
          天眼系统
        </h1>
      </div>
      
      <div class="hidden md:flex items-center space-x-6">
        <div class="flex items-center text-sm">
          <i class="fa fa-user-circle text-neon-blue mr-2"></i>
          <span>菠萝蜜高级管理员</span>
        </div>
        <div class="flex items-center text-sm">
          <i class="fa fa-clock-o text-neon-blue mr-2"></i>
          <span id="current-time">--:--:--</span>
        </div>
        <div class="flex items-center text-sm">
          <i class="fa fa-database text-neon-blue mr-2"></i>
          <span id="record-count">记录总数: 0</span>
        </div>
      </div>
    </div>
    
    <!-- 装饰性光晕效果 -->
    <div class="absolute -top-20 -right-20 w-64 h-64 bg-warm-gold/10 rounded-full blur-3xl"></div>
    <div class="absolute -bottom-10 -left-10 w-40 h-40 bg-neon-blue/10 rounded-full blur-3xl"></div>
  </header>

  <main class="container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-6">
    <!-- 左侧管理栏 - 固定占1/4宽度，文字横向显示 -->
    <aside class="w-full lg:w-1/4 glass-effect rounded-lg p-4 border border-neon-blue/20 h-fit">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <h2 class="text-xl font-cyber font-semibold text-warm-gold flex items-center whitespace-nowrap">
          <i class="fa fa-cogs mr-2"></i>数据管理
        </h2>
        
        <div class="flex flex-wrap gap-2">
          <button id="add-person" class="text-left px-4 py-2 rounded hover:bg-deep-blue/50 transition-all duration-300 flex items-center text-sm whitespace-nowrap">
            <i class="fa fa-user-plus text-green-400 mr-2 w-5 text-center"></i>
            <span>添加人员</span>
          </button>
          <button id="update-data" class="text-left px-4 py-2 rounded hover:bg-deep-blue/50 transition-all duration-300 flex items-center text-sm whitespace-nowrap">
            <i class="fa fa-refresh text-neon-blue mr-2 w-5 text-center"></i>
            <span>更新数据</span>
          </button>
          <button id="clear-all" class="text-left px-4 py-2 rounded hover:bg-deep-blue/50 transition-all duration-300 flex items-center text-sm text-red-300 whitespace-nowrap">
            <i class="fa fa-trash mr-2 w-5 text-center"></i>
            <span>清空所有数据</span>
          </button>
        </div>
      </div>
      
      <div class="mt-4 pt-4 border-t border-neon-blue/20">
        <h3 class="text-md font-cyber mb-3 text-neon-blue flex items-center whitespace-nowrap">
          <i class="fa fa-info-circle mr-1"></i>系统信息
        </h3>
        <div class="space-y-3 text-sm text-gray-300">
          <p><span class="text-warm-gold">版本:</span> v2.3.1</p>
          <p><span class="text-warm-gold">数据库:</span> 活跃</p>
          <p><span class="text-warm-gold">连接数:</span> 1</p>
          <p><span class="text-warm-gold">服务器负荷:</span> 
            <span id="server-load">0%</span>
            <div class="progress-bar bg-deep-blue/50 mt-1">
              <div id="load-bar" class="progress-value bg-neon-blue" style="width: 0%"></div>
            </div>
          </p>
          <p><span class="text-warm-gold">服务器温度:</span> 
            <span id="server-temp">0°C</span>
            <div class="progress-bar bg-deep-blue/50 mt-1">
              <div id="temp-bar" class="progress-value bg-neon-blue" style="width: 0%"></div>
            </div>
          </p>
          <p><span class="text-warm-gold">状态:</span> 正常运行中</p>
        </div>
      </div>
    </aside>

    <!-- 右侧查询区域 - 占3/4宽度 -->
    <section class="flex-1 space-y-6">
      <!-- 查询卡片 -->
      <div class="glass-effect rounded-lg p-6 border border-neon-blue/20">
        <h2 class="text-xl font-cyber font-semibold mb-6 text-warm-gold border-b border-neon-blue/20 pb-2">
          <i class="fa fa-search mr-2"></i>信息查询
        </h2>
        
        <div class="space-y-4">
          <div class="flex flex-wrap gap-4">
            <div class="flex-1 min-w-[280px]">
              <label class="block text-sm text-gray-300 mb-1">查询类型</label>
              <div class="relative">
                <select id="query-type" class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 pr-8 focus:outline-none focus:border-warm-gold transition-colors appearance-none">
                  <option value="name">姓名</option>
                  <option value="id">身份证号</option>
                  <option value="phone">手机号</option>
                  <option value="qq">QQ号</option>
                  <option value="wechat">微信号</option>
                  <option value="douyin">抖音号</option>
                </select>
                <i class="fa fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-xs"></i>
              </div>
            </div>
            
            <div class="flex-1 min-w-[280px]">
              <label class="block text-sm text-gray-300 mb-1">查询内容</label>
              <div class="relative">
                <input type="text" id="query-content" placeholder="请输入查询内容..." 
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
                <button id="query-btn" class="absolute right-1 top-1 bg-warm-gold/80 hover:bg-warm-gold text-space-black px-3 py-1 rounded text-sm transition-colors">
                  <i class="fa fa-search mr-1"></i>查询
                </button>
              </div>
              <div id="query-error" class="error-text hidden"></div>
            </div>
          </div>
          
          <div class="pt-2">
            <div class="flex items-center text-sm text-gray-400">
              <i class="fa fa-lightbulb-o text-warm-gold mr-2"></i>
              <span id="database-population">当前数据库人数: 2,689,451,234</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 结果展示区域 -->
      <div id="result-container" class="glass-effect rounded-lg p-6 border border-neon-blue/20 hidden">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-cyber font-semibold text-warm-gold border-b border-neon-blue/20 pb-2">
            <i class="fa fa-user mr-2"></i>查询结果
            <span id="result-count" class="ml-2 text-sm text-gray-400 font-normal"></span>
          </h2>
          <button id="close-results" class="text-gray-400 hover:text-white transition-colors">
            <i class="fa fa-times"></i> 关闭
          </button>
        </div>
        
        <div id="results" class="space-y-6">
          <!-- 结果将通过JavaScript动态生成 -->
        </div>
        
        <div id="no-result" class="py-12 text-center hidden">
          <i class="fa fa-search-minus text-5xl text-gray-500 mb-4"></i>
          <p class="text-gray-400">未找到匹配的记录</p>
        </div>
      </div>
      
      <!-- 数据列表 -->
      <div class="glass-effect rounded-lg p-6 border border-neon-blue/20">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-cyber font-semibold text-warm-gold">
            <i class="fa fa-list mr-2"></i>人员信息列表
          </h2>
          <div class="text-sm text-gray-400">
            <span id="display-count">显示 0 条记录</span>
          </div>
        </div>
        
        <div class="overflow-x-auto">
          <table class="w-full min-w-[800px]">
            <thead>
              <tr class="border-b border-neon-blue/20">
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">姓名</th>
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">身份证号</th>
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">手机号</th>
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">年龄</th>
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">职业</th>
                <th class="text-left py-3 px-4 text-sm font-cyber text-neon-blue">操作</th>
              </tr>
            </thead>
            <tbody id="data-table-body">
              <tr>
                <td colspan="6" class="py-8 text-center text-gray-500">
                  <i class="fa fa-database mr-2"></i>数据加载中...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>
  
  <!-- 模态框 - 添加人员 -->
  <div id="add-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
    <div class="glass-effect rounded-lg w-full max-w-md border border-neon-blue/30 relative">
      <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
        <i class="fa fa-times"></i>
      </button>
      
      <div class="modal-scroll p-6">
        <h3 id="modal-title" class="text-xl font-cyber font-semibold mb-4 text-warm-gold">添加人员信息</h3>
        
        <form id="add-form" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-300 mb-1">姓名</label>
            <input type="text" id="name" required 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">身份证号</label>
            <input type="text" id="id-card" required 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">手机号</label>
            <input type="text" id="phone" required 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">职业</label>
            <select id="occupation" required
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              <option value="">请选择职业</option>
              <option value="警察">警察</option>
              <option value="工人">工人</option>
              <option value="无业游民">无业游民</option>
              <option value="学生">学生</option>
              <option value="医生">医生</option>
              <option value="消防员">消防员</option>
              <option value="教师">教师</option>
              <option value="工程师">工程师</option>
              <option value="程序员">程序员</option>
              <option value="商人">商人</option>
              <option value="农民">农民</option>
              <option value="护士">护士</option>
              <option value="律师">律师</option>
              <option value="记者">记者</option>
              <option value="公务员">公务员</option>
              <option value="厨师">厨师</option>
              <option value="司机">司机</option>
              <option value="演员">演员</option>
              <option value="作家">作家</option>
              <option value="军人">军人</option>
              <option value="设计师">设计师</option>
              <option value="理发师">理发师</option>
              <option value="服务员">服务员</option>
              <option value="售货员">售货员</option>
              <option value="保安">保安</option>
              <option value="保洁员">保洁员</option>
              <option value="退休人员">退休人员</option>
              <option value="其他">其他</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">QQ号</label>
            <input type="text" id="qq" 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">微信号</label>
            <input type="text" id="wechat" 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">抖音号</label>
            <input type="text" id="douyin" 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div>
            <label class="block text-sm text-gray-300 mb-1">家庭住址</label>
            <input type="text" id="address" 
              class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
          </div>
          
          <div class="pt-2 border-t border-neon-blue/20">
            <h4 class="text-warm-gold text-sm mb-3">家庭成员信息（选填）</h4>
            
            <div class="space-y-4">
              <div>
                <label class="block text-sm text-gray-300 mb-1">父亲姓名</label>
                <input type="text" id="father-name" 
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              </div>
              
              <div>
                <label class="block text-sm text-gray-300 mb-1">父亲身份证号</label>
                <input type="text" id="father-id" 
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              </div>
              
              <div>
                <label class="block text-sm text-gray-300 mb-1">母亲姓名</label>
                <input type="text" id="mother-name" 
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              </div>
              
              <div>
                <label class="block text-sm text-gray-300 mb-1">母亲身份证号</label>
                <input type="text" id="mother-id" 
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              </div>
              
              <div>
                <label class="block text-sm text-gray-300 mb-1">子女信息（格式：姓名,身份证号;姓名,身份证号）</label>
                <input type="text" id="children-info" placeholder="例如：张三,110101199001011234;李四,110101199501011234"
                  class="w-full bg-deep-blue/50 border border-neon-blue/30 rounded px-4 py-2 focus:outline-none focus:border-warm-gold transition-colors">
              </div>
            </div>
          </div>
          
          <div class="pt-4">
            <button type="submit" class="w-full bg-warm-gold/80 hover:bg-warm-gold text-space-black py-2 rounded transition-colors font-medium">
              保存信息
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- 确认对话框 -->
  <div id="confirm-dialog" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
    <div class="glass-effect rounded-lg w-full max-w-md p-6 border border-neon-blue/30">
      <h3 class="text-xl font-cyber font-semibold mb-4 text-warm-gold">确认操作</h3>
      
      <p id="confirm-message" class="mb-6 text-gray-300">您确定要执行此操作吗？</p>
      
      <div class="flex gap-4">
        <button id="confirm-cancel" class="flex-1 bg-gray-700/50 hover:bg-gray-600 py-2 rounded transition-colors">
          取消
        </button>
        <button id="confirm-ok" class="flex-1 bg-red-600/80 hover:bg-red-600 py-2 rounded transition-colors">
          确认
        </button>
      </div>
    </div>
  </div>
  
  <!-- 通知提示 -->
  <div id="notification" class="fixed top-4 right-4 p-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50 max-w-xs"></div>

  <script>
    // 存储人员数据 - 使用localStorage键名区分系统数据和永久数据
    const PERMANENT_DATA_KEY = 'tianyan_permanent_people';
    const SYSTEM_DATA_KEY = 'tianyan_system_people';
    
    let peopleData = [];
    let searchResults = [];
    let currentAction = null;
    // 数据库人口基数（20-30亿之间）
    let basePopulation = 25689451234;
    
    // 真实的身份证地址码前6位
    const realAreaCodes = [
      110000, 110101, 110102, 110105, 120000, 120101, 120102, 130000, 130100, 130102,
      130200, 130202, 140000, 140100, 140105, 150000, 150100, 150102, 210000, 210100,
      210102, 210200, 210202, 220000, 220100, 220102, 230000, 230100, 230102, 310000,
      310101, 310104, 310105, 320000, 320100, 320102, 320200, 320202, 330000, 330100,
      330102, 330200, 330203, 340000, 340100, 340102, 340200, 340202, 350000, 350100,
      350102, 350200, 350203, 360000, 360100, 360102, 360200, 360202, 370000, 370100,
      370102, 370200, 370202, 410000, 410100, 410102, 410200, 410202, 420000, 420100,
      420102, 420200, 420202, 430000, 430100, 430102, 430200, 430202, 440000, 440100,
      440104, 440300, 440303, 450000, 450100, 450102, 450200, 450202, 460000, 460100,
      460105, 500000, 500101, 500102, 510000, 510100, 510104, 510200, 510202, 520000,
      520100, 520102, 520200, 520202, 530000, 530100, 530102, 530300, 530302, 540000,
      540100, 540102, 610000, 610100, 610102, 610200, 610202, 620000, 620100, 620102,
      630000, 630100, 630102, 640000, 640100, 640104, 650000, 650100, 650102
    ];
    
    // 常见姓氏
    const familyNames = ['赵', '钱', '孙', '李', '周', '吴', '郑', '王', '冯', '陈', '褚', '卫', '蒋', '沈', '韩', '杨', '朱', '秦', '尤', '许', '何', '吕', '施', '张', '孔', '曹', '严', '华', '金', '魏', '陶', '姜', '戚', '谢', '邹', '喻', '柏', '水', '窦', '章', '云', '苏', '潘', '葛', '奚', '范', '彭', '郎', '鲁', '韦', '昌', '马', '苗', '凤', '花', '方', '俞', '任', '袁', '柳', '酆', '鲍', '史', '唐', '费', '廉', '岑', '薛', '雷', '贺', '倪', '汤', '滕', '殷', '罗', '毕', '郝', '邬', '安', '常', '乐', '于', '时', '傅', '皮', '卞', '齐', '康', '伍', '余', '元', '卜', '顾', '孟', '平', '黄', '和', '穆', '萧', '尹'];
    
    // 常见名字
    const givenNames = ['伟', '芳', '娜', '秀英', '敏', '静', '强', '磊', '军', '洋', '勇', '艳', '杰', '涛', '明', '超', '军', '秀兰', '建华', '桂英', '晓川', '丽君', '建国', '小丽', '志刚', '曼凝', '小红', '婷婷', '桂兰', '玉华', '秀荣', '志强', '惠芳', '建平', '颖', '海涛', '天明', '俊杰', '玉兰', '文杰', '玉梅', '静', '秀华', '鹏飞', '丽', '芳', '琳', '红梅', '静', '海燕', '桂英', '秀兰', '志强', '建军', '晓燕', '伟', '秀珍', '敏', '娜', '伟', '静', '秀芳', '勇', '军', '洋', '艳', '杰', '涛', '明', '超', '秀兰', '建华', '桂英', '红梅', '建国', '小丽', '志刚', '小红', '婷婷', '韵涵', '一鸣', '亦菲'];
    
    // 常见职业
    const occupations = ['警察', '工人', '无业游民', '学生', '医生', '消防员', '教师', '工程师', '程序员', '商人', '农民', '护士', '律师', '记者', '公务员', '厨师', '司机', '演员', '作家', '军人', '设计师', '理发师', '服务员', '售货员', '保安', '保洁员', '退休人员', '其他'];
    
    // 常见地址
    const provinces = ['北京市', '上海市', '天津市', '重庆市', '河北省', '山西省', '辽宁省', '吉林省', '黑龙江省', '江苏省', '浙江省', '安徽省', '福建省', '江西省', '山东省', '河南省', '湖北省', '湖南省', '广东省', '海南省', '四川省', '贵州省', '云南省', '陕西省', '甘肃省', '青海省', '台湾省', '内蒙古自治区', '广西壮族自治区', '宁夏回族自治区', '新疆维吾尔自治区', '西藏自治区', '香港特别行政区', '澳门特别行政区'];
    
    // 从localStorage加载永久数据
    function loadPermanentData() {
      const data = localStorage.getItem(PERMANENT_DATA_KEY);
      return data ? JSON.parse(data) : [];
    }
    
    // 保存永久数据到localStorage
    function savePermanentData(data) {
      localStorage.setItem(PERMANENT_DATA_KEY, JSON.stringify(data));
    }
    
    // 从localStorage加载系统数据
    function loadSystemData() {
      const data = localStorage.getItem(SYSTEM_DATA_KEY);
      return data ? JSON.parse(data) : [];
    }
    
    // 保存系统数据到localStorage
    function saveSystemData(data) {
      localStorage.setItem(SYSTEM_DATA_KEY, JSON.stringify(data));
    }
    
    // 生成随机姓名
    function generateName() {
      const familyName = familyNames[Math.floor(Math.random() * familyNames.length)];
      const givenName = givenNames[Math.floor(Math.random() * givenNames.length)];
      return familyName + givenName;
    }
    
    // 提取姓氏
    function getFamilyName(fullName) {
      if (!fullName) return '';
      return fullName.charAt(0);
    }
    
    // 提取名字
    function getGivenName(fullName) {
      if (!fullName || fullName.length <= 1) return fullName;
      return fullName.substring(1);
    }
    
    // 生成随机身份证号
    function generateIdCard() {
      // 随机选择地址码
      const areaCode = realAreaCodes[Math.floor(Math.random() * realAreaCodes.length)];
      
      // 生成1950-2005年之间的出生日期
      const year = Math.floor(Math.random() * 56) + 1950;
      const month = Math.floor(Math.random() * 12) + 1;
      const day = Math.floor(Math.random() * 28) + 1; // 简化处理，统一按28天算
      
      const birthDate = `${year}${String(month).padStart(2, '0')}${String(day).padStart(2, '0')}`;
      
      // 生成3位顺序码
      const sequence = String(Math.floor(Math.random() * 1000)).padStart(3, '0');
      
      // 随机生成校验码
      const checkCodes = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'X'];
      const checkCode = checkCodes[Math.floor(Math.random() * checkCodes.length)];
      
      return `${areaCode}${birthDate}${sequence}${checkCode}`;
    }
    
    // 生成随机手机号
    function generatePhone() {
      const prefixes = ['130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '170', '171', '173', '176', '177', '178', '180', '181', '182', '183', '184', '185', '186', '187', '188', '189'];
      const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
      const suffix = Math.floor(Math.random() * 100000000).toString().padStart(8, '0');
      return prefix + suffix;
    }
    
    // 从身份证号计算年龄
    function calculateAge(idCard) {
      if (idCard.length !== 18) return 0;
      
      const birthYear = parseInt(idCard.substring(6, 10));
      const birthMonth = parseInt(idCard.substring(10, 12));
      const birthDay = parseInt(idCard.substring(12, 14));
      
      const today = new Date();
      const currentYear = today.getFullYear();
      const currentMonth = today.getMonth() + 1;
      const currentDay = today.getDate();
      
      let age = currentYear - birthYear;
      
      // 如果还没过生日，年龄减1
      if (currentMonth < birthMonth || (currentMonth === birthMonth && currentDay < birthDay)) {
        age--;
      }
      
      return age < 0 ? 0 : age;
    }
    
    // 生成随机地址
    function generateAddress() {
      const province = provinces[Math.floor(Math.random() * provinces.length)];
      const city = `${Math.floor(Math.random() * 10) + 1}市`;
      const district = `${Math.floor(Math.random() * 20) + 1}区`;
      const street = `${Math.floor(Math.random() * 100) + 1}街道`;
      const number = `${Math.floor(Math.random() * 1000) + 1}号`;
      const unit = `(${Math.floor(Math.random() * 20) + 1}单元${Math.floor(Math.random() * 30) + 1}室)`;
      
      return `${province}${city}${district}${street}${number}${unit}`;
    }
    
    // 生成随机QQ号
    function generateQQ() {
      return Math.floor(10000000 + Math.random() * 900000000).toString();
    }
    
    // 生成随机微信号
    function generateWechat() {
      const prefixes = ['wx', 'wxid', 'v', 'wx_', 'wechat_'];
      const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
      const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
      let suffix = '';
      
      for (let i = 0; i < Math.floor(Math.random() * 8) + 6; i++) {
        suffix += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      
      return prefix + suffix;
    }
    
    // 生成随机抖音号
    function generateDouyin() {
      const prefixes = ['dy', 'douyin', ''];
      const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
      const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
      let suffix = '';
      
      for (let i = 0; i < Math.floor(Math.random() * 6) + 8; i++) {
        suffix += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      
      return prefix + suffix;
    }
    
    // 生成随机人员数据，实现子女随父亲姓，父亲随子女姓的特殊规则
    function generatePerson(customFields = {}) {
      // 生成一个随机的孩子
      const childFamilyName = familyNames[Math.floor(Math.random() * familyNames.length)];
      const childGivenName = givenNames[Math.floor(Math.random() * givenNames.length)];
      const childName = childFamilyName + childGivenName;
      
      // 父亲随子女姓（父亲的姓等于孩子的姓）
      const fatherFamilyName = childFamilyName;
      const fatherGivenName = givenNames[Math.floor(Math.random() * givenNames.length)];
      const fatherName = fatherFamilyName + fatherGivenName;
      
      // 母亲姓名随机生成
      const motherFamilyName = familyNames[Math.floor(Math.random() * familyNames.length)];
      const motherGivenName = givenNames[Math.floor(Math.random() * givenNames.length)];
      const motherName = motherFamilyName + motherGivenName;
      
      // 如果有自定义字段，则使用自定义字段的值
      const name = customFields.name || generateName();
      const id = customFields.id || generateIdCard();
      const phone = customFields.phone || generatePhone();
      const occupation = customFields.occupation || occupations[Math.floor(Math.random() * occupations.length)];
      const age = calculateAge(id);
      const qq = customFields.qq || (Math.random() > 0.3 ? generateQQ() : ''); // 30%概率没有QQ号
      const wechat = customFields.wechat || (Math.random() > 0.2 ? generateWechat() : ''); // 20%概率没有微信号
      const douyin = customFields.douyin || (Math.random() > 0.6 ? generateDouyin() : ''); // 60%概率没有抖音号
      const address = customFields.address || generateAddress();
      
      // 随机生成子女信息（子女随父亲姓）
      const hasChildren = Math.random() > 0.3; // 70%概率有子女
      let childrenInfo = '';
      
      if (hasChildren) {
        const childCount = Math.floor(Math.random() * 3) + 1; // 1-3个子女
        const children = [];
        
        // 父亲的姓
        const personFamilyName = getFamilyName(name);
        
        for (let i = 0; i < childCount; i++) {
          // 子女随父亲姓
          const childGivenName = givenNames[Math.floor(Math.random() * givenNames.length)];
          const childFullName = personFamilyName + childGivenName;
          children.push(`${childFullName},${generateIdCard()}`);
        }
        
        childrenInfo = children.join(';');
      }
      
      // 随机决定是否显示父亲信息（约50%概率）
      const showFatherInfo = Math.random() > 0.5;
      // 随机决定是否显示母亲信息（约50%概率）
      const showMotherInfo = Math.random() > 0.5;
      
      return {
        name,
        id,
        phone,
        occupation,
        age,
        qq,
        wechat,
        douyin,
        address,
        fatherName: showFatherInfo ? fatherName : '',
        fatherId: showFatherInfo ? generateIdCard() : '',
        motherName: showMotherInfo ? motherName : '',
        motherId: showMotherInfo ? generateIdCard() : '',
        childrenInfo: childrenInfo
      };
    }
    
    // 生成多条随机数据
    function generatePeopleData(count = 10, customFields = {}) {
      const data = [];
      for (let i = 0; i < count; i++) {
        data.push(generatePerson(customFields));
      }
      return data;
    }
    
    // 验证身份证号格式
    function validateIdCard(idCard) {
      const reg = /(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
      return reg.test(idCard);
    }
    
    // 验证手机号格式
    function validatePhone(phone) {
      const reg = /^1[3-9]\d{9}$/;
      return reg.test(phone);
    }
    
    // 页面加载时生成数据
    document.addEventListener('DOMContentLoaded', function() {
      // 从localStorage加载永久数据
      let permanentData = loadPermanentData();
      
      // 检查是否已有乔镘凝数据，如果没有则添加
      const hasQiaoManying = permanentData.some(person => person.name === '乔镘凝');
      if (!hasQiaoManying) {
        const qiaoManying = {
          name: '乔镘凝',
          id: '141000200505293687',
          phone: '13008021728',
          qq: '2304940922',
          douyin: 'xiaoqiao20050529',
          address: '山西省合肥市蜀山区',
          age: calculateAge('141000200505293687'),
          occupation: '无业游民',
          wechat: '',
          fatherName: '乔志远',
          fatherId: '141000197308213517',
          motherName: '乔湘红',
          motherId: '341200197312056421',
          childrenInfo: ''
        };
        permanentData.push(qiaoManying);
        savePermanentData(permanentData);
      }
      
      // 从localStorage加载系统数据
      let systemData = loadSystemData();
      
      // 如果系统数据为空，生成一些随机数据
      if (systemData.length === 0) {
        const count = Math.floor(Math.random() * 11) + 10;
        systemData = generatePeopleData(count);
        saveSystemData(systemData);
      }
      
      // 合并永久数据和系统数据
      peopleData = [...permanentData, ...systemData];
      
      // 更新表格显示
      updateTable();
      
      // 更新记录计数
      updateRecordCount();
      
      // 其他初始化操作...
      updateServerStats();
      // 服务器状态更新频率减小为30秒一次
      setInterval(updateServerStats, 30000);
      
      // 更新时间
      updateTime();
      setInterval(updateTime, 1000);
      
      // 绑定事件监听器
      document.getElementById('add-person').addEventListener('click', openAddModal);
      document.getElementById('close-modal').addEventListener('click', closeModal);
      document.getElementById('add-form').addEventListener('submit', handleAddFormSubmit);
      document.getElementById('clear-all').addEventListener('click', handleClearAll);
      document.getElementById('update-data').addEventListener('click', handleUpdateData);
      document.getElementById('confirm-cancel').addEventListener('click', closeConfirmDialog);
      document.getElementById('confirm-ok').addEventListener('click', executeConfirmAction);
      document.getElementById('query-btn').addEventListener('click', performSearch);
      document.getElementById('close-results').addEventListener('click', closeResults);
      
      // 支持回车键查询
      document.getElementById('query-content').addEventListener('keyup', function(e) {
        if (e.key === 'Enter') {
          performSearch();
        }
      });
    });
    
    // 更新表格显示
    function updateTable() {
      const tableBody = document.getElementById('data-table-body');
      
      if (peopleData.length === 0) {
        tableBody.innerHTML = `
          <tr>
            <td colspan="6" class="py-8 text-center text-gray-500">
              <i class="fa fa-database mr-2"></i>暂无数据，请添加数据
            </td>
          </tr>
        `;
        document.getElementById('display-count').textContent = '显示 0 条记录';
        return;
      }
      
      let html = '';
      peopleData.forEach((person, index) => {
        // 检查是否为永久数据
        const permanentData = loadPermanentData();
        const isPermanent = permanentData.some(p => p.id === person.id);
        
        html += `
          <tr class="border-b border-neon-blue/10 hover:bg-deep-blue/20 transition-colors">
            <td class="py-3 px-4">
              ${person.name}
              ${isPermanent ? '<span class="ml-2 text-xs bg-warm-gold/20 text-warm-gold px-1 rounded">永久</span>' : ''}
            </td>
            <td class="py-3 px-4">${person.id}</td>
            <td class="py-3 px-4">${person.phone}</td>
            <td class="py-3 px-4">${person.age}</td>
            <td class="py-3 px-4">${person.occupation}</td>
            <td class="py-3 px-4">
              <div class="flex space-x-2">
                <button onclick="viewPerson(${index})" class="text-neon-blue hover:text-glow-blue transition-colors" title="查看">
                  <i class="fa fa-eye"></i>
                </button>
                <button onclick="editPerson(${index})" class="text-warm-gold hover:text-yellow-300 transition-colors" title="编辑">
                  <i class="fa fa-pencil"></i>
                </button>
                <button onclick="deletePerson(${index})" class="text-red-400 hover:text-red-300 transition-colors ${isPermanent ? 'opacity-50 cursor-not-allowed' : ''}" title="${isPermanent ? '永久数据不可删除' : '删除'}" ${isPermanent ? 'disabled' : ''}>
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });
      
      tableBody.innerHTML = html;
      document.getElementById('display-count').textContent = `显示 ${peopleData.length} 条记录`;
    }
    
    // 更新记录计数
    function updateRecordCount() {
      document.getElementById('record-count').textContent = `记录总数: ${peopleData.length}`;
    }
    
    // 更新服务器状态 - 减小了变化频率和幅度
    function updateServerStats() {
      // 减小负荷变化范围（从10-70%改为20-60%）
      const load = Math.floor(Math.random() * 40) + 20; 
      // 减小温度变化范围（从30-50°C改为35-45°C）
      const temp = Math.floor(Math.random() * 10) + 35; 
      
      document.getElementById('server-load').textContent = `${load}%`;
      document.getElementById('load-bar').style.width = `${load}%`;
      
      document.getElementById('server-temp').textContent = `${temp}°C`;
      document.getElementById('temp-bar').style.width = `${temp * 2}%`;
      
      // 减小数据库人口数波动范围（从-50,000到+50,000改为-10,000到+10,000）
      const fluctuation = Math.floor(Math.random() * 20000) - 10000; 
      basePopulation += fluctuation;
      
      // 格式化人口数为带逗号的格式
      const formattedPopulation = basePopulation.toLocaleString();
      document.getElementById('database-population').textContent = `当前数据库人数: ${formattedPopulation}`;
    }
    
    // 更新时间
    function updateTime() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('current-time').textContent = `${hours}:${minutes}:${seconds}`;
    }
    
    // 打开添加人员模态框
    function openAddModal() {
      document.getElementById('modal-title').textContent = '添加人员信息';
      document.getElementById('add-form').reset();
      document.getElementById('add-modal').classList.remove('hidden');
      currentAction = { type: 'add' };
    }
    
    // 关闭模态框
    function closeModal() {
      document.getElementById('add-modal').classList.add('hidden');
      currentAction = null;
    }
    
    // 处理添加表单提交
    function handleAddFormSubmit(e) {
      e.preventDefault();
      
      const person = {
        name: document.getElementById('name').value,
        id: document.getElementById('id-card').value,
        phone: document.getElementById('phone').value,
        occupation: document.getElementById('occupation').value,
        age: calculateAge(document.getElementById('id-card').value),
        qq: document.getElementById('qq').value,
        wechat: document.getElementById('wechat').value,
        douyin: document.getElementById('douyin').value,
        address: document.getElementById('address').value,
        fatherName: document.getElementById('father-name').value,
        fatherId: document.getElementById('father-id').value,
        motherName: document.getElementById('mother-name').value,
        motherId: document.getElementById('mother-id').value,
        childrenInfo: document.getElementById('children-info').value
      };
      
      // 处理子女随父亲姓的逻辑
      if (person.childrenInfo && person.name) {
        const personFamilyName = getFamilyName(person.name);
        const children = person.childrenInfo.split(';');
        const updatedChildren = [];
        
        children.forEach(child => {
          if (child.trim()) {
            const [childName, childId] = child.split(',');
            if (childName) {
              // 确保子女姓与父亲一致
              const childGivenName = getGivenName(childName);
              const updatedChildName = personFamilyName + childGivenName;
              updatedChildren.push(`${updatedChildName}${childId ? ',' + childId : ''}`);
            }
          }
        });
        
        person.childrenInfo = updatedChildren.join(';');
      }
      
      // 处理父亲随子女姓的逻辑
      if (person.fatherName && person.childrenInfo) {
        const children = person.childrenInfo.split(';');
        if (children.length > 0) {
          const firstChild = children[0].split(',')[0];
          if (firstChild) {
            const childFamilyName = getFamilyName(firstChild);
            const fatherGivenName = getGivenName(person.fatherName);
            person.fatherName = childFamilyName + fatherGivenName;
          }
        }
      }
      
      // 从localStorage获取永久数据
      let permanentData = loadPermanentData();
      
      if (currentAction.type === 'add') {
        // 添加为永久数据
        permanentData.push(person);
        savePermanentData(permanentData);
        
        // 更新当前数据列表
        const systemData = loadSystemData();
        peopleData = [...permanentData, ...systemData];
        
        showNotification('添加成功（永久保存）', 'success');
      } else if (currentAction.type === 'edit') {
        // 检查是否是永久数据
        const permanentData = loadPermanentData();
        const systemData = loadSystemData();
        
        // 查找索引
        const isPermanentIndex = permanentData.findIndex(p => p.id === peopleData[currentAction.index].id);
        
        if (isPermanentIndex !== -1) {
          // 更新永久数据
          permanentData[isPermanentIndex] = person;
          savePermanentData(permanentData);
        } else {
          // 更新系统数据
          const systemIndex = systemData.findIndex(p => p.id === peopleData[currentAction.index].id);
          if (systemIndex !== -1) {
            systemData[systemIndex] = person;
            saveSystemData(systemData);
          }
        }
        
        // 更新当前数据列表
        peopleData = [...permanentData, ...systemData];
        showNotification('更新成功', 'success');
      }
      
      closeModal();
      updateTable();
      updateRecordCount();
    }
    
    // 查看人员信息
    function viewPerson(index) {
      const person = peopleData[index];
      
      // 构建家庭成员信息HTML
      let familyHtml = '';
      
      if (person.fatherName) {
        familyHtml += `
          <div class="mt-2">
            <span class="text-warm-gold">父亲:</span> ${person.fatherName} (${person.fatherId || '无身份证号'})
          </div>
        `;
      }
      
      if (person.motherName) {
        familyHtml += `
          <div class="mt-2">
            <span class="text-warm-gold">母亲:</span> ${person.motherName} (${person.motherId || '无身份证号'})
          </div>
        `;
      }
      
      if (person.childrenInfo) {
        familyHtml += `<div class="mt-2"><span class="text-warm-gold">子女:</span></div>`;
        const children = person.childrenInfo.split(';');
        children.forEach(child => {
          const [childName, childId] = child.split(',');
          familyHtml += `
            <div class="ml-4 mt-1">${childName} (${childId || '无身份证号'})</div>
          `;
        });
      }
      
      if (!familyHtml) {
        familyHtml = '<div class="text-gray-400 italic">无家庭成员信息</div>';
      }
      
      // 检查是否为永久数据
      const permanentData = loadPermanentData();
      const isPermanent = permanentData.some(p => p.id === person.id);
      
      // 构建人员信息HTML
      const personHtml = `
        <div class="glass-effect rounded-lg p-6 border border-neon-blue/20">
          <div class="flex justify-between items-start mb-4">
            <h3 class="text-xl font-cyber font-semibold text-warm-gold">
              ${person.name}
              ${isPermanent ? '<span class="ml-2 text-sm bg-warm-gold/20 text-warm-gold px-1 rounded">永久</span>' : ''}
            </h3>
            <div class="flex space-x-2">
              <button onclick="editPerson(${index})" class="text-warm-gold hover:text-yellow-300 transition-colors" title="编辑">
                <i class="fa fa-pencil"></i>
              </button>
              <button onclick="deletePerson(${index})" class="text-red-400 hover:text-red-300 transition-colors ${isPermanent ? 'opacity-50 cursor-not-allowed' : ''}" title="${isPermanent ? '永久数据不可删除' : '删除'}" ${isPermanent ? 'disabled' : ''}>
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>
          
          <div class="space-y-3">
            <div><span class="text-neon-blue">身份证号:</span> ${person.id}</div>
            <div><span class="text-neon-blue">手机号:</span> ${person.phone}</div>
            <div><span class="text-neon-blue">年龄:</span> ${person.age}岁</div>
            <div><span class="text-neon-blue">职业:</span> ${person.occupation}</div>
            ${person.qq ? `<div><span class="text-neon-blue">QQ号:</span> ${person.qq}</div>` : ''}
            ${person.wechat ? `<div><span class="text-neon-blue">微信号:</span> ${person.wechat}</div>` : ''}
            ${person.douyin ? `<div><span class="text-neon-blue">抖音号:</span> ${person.douyin}</div>` : ''}
            ${person.address ? `<div><span class="text-neon-blue">家庭住址:</span> ${person.address}</div>` : ''}
            
            <div class="mt-4 pt-4 border-t border-neon-blue/20">
              <h4 class="text-warm-gold text-sm mb-2">家庭成员信息</h4>
              ${familyHtml}
            </div>
          </div>
        </div>
      `;
      
      // 显示在结果区域
      document.getElementById('results').innerHTML = personHtml;
      document.getElementById('result-count').textContent = `(1 条记录)`;
      document.getElementById('no-result').classList.add('hidden');
      document.getElementById('result-container').classList.remove('hidden');
    }
    
    // 编辑人员信息
    function editPerson(index) {
      const person = peopleData[index];
      
      document.getElementById('modal-title').textContent = '编辑人员信息';
      document.getElementById('name').value = person.name;
      document.getElementById('id-card').value = person.id;
      document.getElementById('phone').value = person.phone;
      document.getElementById('occupation').value = person.occupation;
      document.getElementById('qq').value = person.qq;
      document.getElementById('wechat').value = person.wechat;
      document.getElementById('douyin').value = person.douyin;
      document.getElementById('address').value = person.address;
      document.getElementById('father-name').value = person.fatherName;
      document.getElementById('father-id').value = person.fatherId;
      document.getElementById('mother-name').value = person.motherName;
      document.getElementById('mother-id').value = person.motherId;
      document.getElementById('children-info').value = person.childrenInfo;
      
      document.getElementById('add-modal').classList.remove('hidden');
      currentAction = { type: 'edit', index };
    }
    
    // 删除人员信息
    function deletePerson(index) {
      const person = peopleData[index];
      
      // 检查是否为永久数据
      const permanentData = loadPermanentData();
      const isPermanent = permanentData.some(p => p.id === person.id);
      
      if (isPermanent) {
        showNotification('永久数据不可删除', 'error');
        return;
      }
      
      currentAction = { type: 'delete', index };
      document.getElementById('confirm-message').textContent = `您确定要消除 ${person.name} 的户籍吗？`;
      document.getElementById('confirm-dialog').classList.remove('hidden');
    }
    
    // 处理清空所有数据
    function handleClearAll() {
      // 只清空系统数据，保留永久数据
      const permanentDataCount = loadPermanentData().length;
      
      if (peopleData.length === permanentDataCount) {
        showNotification('只能清空非永久数据，已没有可清空的数据', 'info');
        return;
      }
      
      currentAction = { type: 'clearAll' };
      document.getElementById('confirm-message').textContent = '您确定要清空所有非永久人员信息吗？此操作不可恢复！';
      document.getElementById('confirm-dialog').classList.remove('hidden');
    }
    
    // 处理更新数据
    function handleUpdateData() {
      // 只更新系统数据，保留永久数据
      const count = Math.floor(Math.random() * 11) + 10;
      const systemData = generatePeopleData(count);
      saveSystemData(systemData);
      
      const permanentData = loadPermanentData();
      peopleData = [...permanentData, ...systemData];
      
      updateTable();
      updateRecordCount();
      showNotification('系统数据已更新（永久数据保留）', 'success');
    }
    
    // 关闭确认对话框
    function closeConfirmDialog() {
      document.getElementById('confirm-dialog').classList.add('hidden');
      currentAction = null;
    }
    
    // 执行确认的操作
    function executeConfirmAction() {
      if (currentAction.type === 'delete') {
        const deletedPerson = peopleData[currentAction.index];
        
        // 从系统数据中删除
        let systemData = loadSystemData();
        systemData = systemData.filter(p => p.id !== deletedPerson.id);
        saveSystemData(systemData);
        
        // 更新当前数据列表
        const permanentData = loadPermanentData();
        peopleData = [...permanentData, ...systemData];
        
        updateTable();
        updateRecordCount();
        showNotification(`已删除 ${deletedPerson.name} 的信息`, 'success');
      } else if (currentAction.type === 'clearAll') {
        // 清空系统数据，但保留永久数据
        saveSystemData([]);
        
        const permanentData = loadPermanentData();
        peopleData = [...permanentData];
        
        updateTable();
        updateRecordCount();
        showNotification('所有非永久数据已清空', 'success');
      }
      
      closeConfirmDialog();
      closeResults();
    }
    
    // 执行搜索
    function performSearch() {
      const queryType = document.getElementById('query-type').value;
      const queryContent = document.getElementById('query-content').value.trim();
      const errorElement = document.getElementById('query-error');
      const queryInput = document.getElementById('query-content');
      
      // 清除之前的错误状态
      errorElement.classList.add('hidden');
      queryInput.classList.remove('error-border');
      
      // 验证输入
      if (!queryContent) {
        showError('请输入查询内容', errorElement, queryInput);
        return;
      }
      
      // 特定类型的格式验证
      if (queryType === 'id' && !validateIdCard(queryContent)) {
        showError('请输入有效的18位身份证号', errorElement, queryInput);
        return;
      }
      
      if (queryType === 'phone' && !validatePhone(queryContent)) {
        showError('请输入有效的11位手机号', errorElement, queryInput);
        return;
      }
      
      // 先从现有数据中查找匹配项
      const matches = peopleData.filter(person => {
        if (queryType === 'name') {
          return person.name.includes(queryContent);
        } else if (queryType === 'id') {
          return person.id === queryContent;
        } else if (queryType === 'phone') {
          return person.phone === queryContent;
        } else if (queryType === 'qq') {
          return person.qq === queryContent;
        } else if (queryType === 'wechat') {
          return person.wechat === queryContent;
        } else if (queryType === 'douyin') {
          return person.douyin === queryContent;
        }
        return false;
      });
      
      // 如果找到匹配项，直接使用
      if (matches.length > 0) {
        searchResults = matches;
      } else {
        // 没有找到匹配项，生成新数据
        if (queryType === 'name') {
          // 姓名查询：生成3-15个同名的人
          const count = Math.floor(Math.random() * 13) + 3; // 3-15
          searchResults = generatePeopleData(count, { name: queryContent });
        } else {
          // 其他类型查询：生成1个匹配的人
          const customFields = {};
          customFields[queryType] = queryContent;
          searchResults = generatePeopleData(1, customFields);
        }
      }
      
      // 显示搜索结果
      displaySearchResults();
    }
    
    // 显示错误信息
    function showError(message, errorElement, inputElement) {
      errorElement.textContent = message;
      errorElement.classList.remove('hidden');
      inputElement.classList.add('error-border');
    }
    
    // 显示搜索结果
    function displaySearchResults() {
      if (searchResults.length === 0) {
        document.getElementById('results').innerHTML = '';
        document.getElementById('result-count').textContent = '';
        document.getElementById('no-result').classList.remove('hidden');
        document.getElementById('result-container').classList.remove('hidden');
        return;
      }
      
      let resultsHtml = '';
      searchResults.forEach((person, index) => {
        // 检查是否为永久数据
        const permanentData = loadPermanentData();
        const isPermanent = permanentData.some(p => p.id === person.id);
        
        // 构建简要信息HTML
        resultsHtml += `
          <div class="glass-effect rounded-lg p-4 border border-neon-blue/20 hover:border-neon-blue/50 transition-colors">
            <div class="flex justify-between items-start">
              <div>
                <h3 class="text-lg font-cyber font-semibold text-warm-gold">
                  ${person.name}
                  ${isPermanent ? '<span class="ml-2 text-xs bg-warm-gold/20 text-warm-gold px-1 rounded">永久</span>' : ''}
                </h3>
                <div class="mt-2 space-y-1 text-sm">
                  <div><span class="text-neon-blue">身份证号:</span> ${person.id}</div>
                  <div><span class="text-neon-blue">手机号:</span> ${person.phone}</div>
                  <div><span class="text-neon-blue">年龄:</span> ${person.age}岁</div>
                  <div><span class="text-neon-blue">职业:</span> ${person.occupation}</div>
                </div>
              </div>
              <button onclick="viewSearchResult(${index})" class="text-neon-blue hover:text-glow-blue transition-colors px-3 py-1 border border-neon-blue/30 rounded text-sm">
                查看详情
              </button>
            </div>
          </div>
        `;
      });
      
      document.getElementById('results').innerHTML = resultsHtml;
      document.getElementById('result-count').textContent = `(${searchResults.length} 条记录)`;
      document.getElementById('no-result').classList.add('hidden');
      document.getElementById('result-container').classList.remove('hidden');
    }
    
    // 查看搜索结果详情
    function viewSearchResult(index) {
      const person = searchResults[index];
      
      // 构建家庭成员信息HTML
      let familyHtml = '';
      
      if (person.fatherName) {
        familyHtml += `
          <div class="mt-2">
            <span class="text-warm-gold">父亲:</span> ${person.fatherName} (${person.fatherId || '无身份证号'})
          </div>
        `;
      }
      
      if (person.motherName) {
        familyHtml += `
          <div class="mt-2">
            <span class="text-warm-gold">母亲:</span> ${person.motherName} (${person.motherId || '无身份证号'})
          </div>
        `;
      }
      
      if (person.childrenInfo) {
        familyHtml += `<div class="mt-2"><span class="text-warm-gold">子女:</span></div>`;
        const children = person.childrenInfo.split(';');
        children.forEach(child => {
          const [childName, childId] = child.split(',');
          familyHtml += `
            <div class="ml-4 mt-1">${childName} (${childId || '无身份证号'})</div>
          `;
        });
      }
      
      if (!familyHtml) {
        familyHtml = '<div class="text-gray-400 italic">无家庭成员信息</div>';
      }
      
      // 检查是否为永久数据
      const permanentData = loadPermanentData();
      const isPermanent = permanentData.some(p => p.id === person.id);
      
      // 构建人员信息HTML
      const personHtml = `
        <div class="glass-effect rounded-lg p-6 border border-neon-blue/20">
          <div class="flex justify-between items-start mb-4">
            <h3 class="text-xl font-cyber font-semibold text-warm-gold">
              ${person.name}
              ${isPermanent ? '<span class="ml-2 text-sm bg-warm-gold/20 text-warm-gold px-1 rounded">永久</span>' : ''}
            </h3>
            <button onclick="displaySearchResults()" class="text-gray-400 hover:text-white transition-colors" title="返回列表">
              <i class="fa fa-arrow-left"></i> 返回列表
            </button>
          </div>
          
          <div class="space-y-3">
            <div><span class="text-neon-blue">身份证号:</span> ${person.id}</div>
            <div><span class="text-neon-blue">手机号:</span> ${person.phone}</div>
            <div><span class="text-neon-blue">年龄:</span> ${person.age}岁</div>
            <div><span class="text-neon-blue">职业:</span> ${person.occupation}</div>
            ${person.qq ? `<div><span class="text-neon-blue">QQ号:</span> ${person.qq}</div>` : ''}
            ${person.wechat ? `<div><span class="text-neon-blue">微信号:</span> ${person.wechat}</div>` : ''}
            ${person.douyin ? `<div><span class="text-neon-blue">抖音号:</span> ${person.douyin}</div>` : ''}
            ${person.address ? `<div><span class="text-neon-blue">家庭住址:</span> ${person.address}</div>` : ''}
            
            <div class="mt-4 pt-4 border-t border-neon-blue/20">
              <h4 class="text-warm-gold text-sm mb-2">家庭成员信息</h4>
              ${familyHtml}
            </div>
          </div>
        </div>
      `;
      
      // 显示详情
      document.getElementById('results').innerHTML = personHtml;
    }
    
    // 关闭搜索结果
    function closeResults() {
      document.getElementById('result-container').classList.add('hidden');
    }
    
    // 显示通知
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      
      // 设置通知样式
      if (type === 'success') {
        notification.className = 'fixed top-4 right-4 p-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50 max-w-xs bg-green-900/80 border border-green-500 text-white';
      } else if (type === 'error') {
        notification.className = 'fixed top-4 right-4 p-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50 max-w-xs bg-red-900/80 border border-red-500 text-white';
      } else {
        notification.className = 'fixed top-4 right-4 p-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50 max-w-xs bg-blue-900/80 border border-blue-500 text-white';
      }
      
      notification.textContent = message;
      
      // 显示通知
      setTimeout(() => {
        notification.classList.remove('translate-x-full');
      }, 10);
      
      // 3秒后隐藏通知
      setTimeout(() => {
        notification.classList.add('translate-x-full');
      }, 3000);
    }
    
    // 暴露函数到全局
    window.viewPerson = viewPerson;
    window.editPerson = editPerson;
    window.deletePerson = deletePerson;
    window.viewSearchResult = viewSearchResult;
    window.displaySearchResults = displaySearchResults;
  </script>
</body>
</html>
